---
import PageLayout from "../layouts/PageLayout.astro";
import SEO from "../components/SEO.astro";
import JsonLd from "../components/JsonLd.astro";
import { createFaqSchema, createBreadcrumbSchema } from "../lib/schemas";
import { PricingTable } from "@clerk/astro/components";
import Card from "../components/starwind/card/Card.astro";
import CardContent from "../components/starwind/card/CardContent.astro";
import { SITE_URL, SITE_NAME } from "../lib/config";

const pricingFaqs = [
  {
    question: "What payment methods do you accept?",
    answer:
      "We accept all major credit cards (Visa, Mastercard, American Express) through our secure payment processor, Stripe.",
  },
  {
    question: "Can I change my plan later?",
    answer:
      "Yes! You can upgrade or downgrade your plan at any time. Changes take effect at the start of your next billing period.",
  },
  {
    question: "Is there a free trial?",
    answer: `You can try ${SITE_NAME} with a limited set of features before subscribing. Sign up to see what's available in the free tier.`,
  },
  {
    question: "How do I cancel my subscription?",
    answer:
      "You can cancel anytime from your account settings. Click your profile icon and select 'Manage Account' to access billing options. Your access continues until the end of your current billing period.",
  },
  {
    question: "Do you offer refunds?",
    answer:
      "We don't offer refunds for partial billing periods. However, if you're unsatisfied within the first 7 days, contact us and we'll work something out.",
  },
];

const breadcrumbs = [
  { name: "Home", url: SITE_URL },
  { name: "Pricing", url: `${SITE_URL}/pricing` },
];
---

<PageLayout
  title="Pick Your Plan"
  subtitle="Less planning, more playing"
  pageTitle={`Pricing - ${SITE_NAME}`}
>
  <SEO
    slot="head"
    title={`Pricing - ${SITE_NAME} | Free & Premium Plans`}
    description={`End the "where should we go?" debate. Start free with 5 parks and 1 daily pick, or unlock everything for just $1/month. Cancel anytime.`}
  >
    <JsonLd schema={createFaqSchema(pricingFaqs)} />
    <JsonLd schema={createBreadcrumbSchema(breadcrumbs)} />
  </SEO>
  <!-- Custom Pricing Cards -->
  <div class="mb-8 grid gap-6 md:grid-cols-2">
    <!-- Free Plan -->
    <Card class="border-white/15 bg-white/10 backdrop-blur-xl">
      <CardContent class="p-6">
        <div class="mb-4 flex items-baseline justify-between">
          <h2 class="text-cream font-[Fraunces] text-2xl font-bold">Free</h2>
          <span class="text-gold text-xl font-semibold">$0</span>
        </div>
        <p class="text-mist mb-6 leading-relaxed">
          End the "where should we go?" debate. Let your kid tap the button and pick your next
          adventure.
        </p>
        <ul class="text-cream space-y-3 text-sm">
          <li class="flex items-center gap-2">
            <span class="text-gold">✓</span>
            5 parks to discover
          </li>
          <li class="flex items-center gap-2">
            <span class="text-gold">✓</span>
            1 pick per day
          </li>
          <li class="flex items-center gap-2">
            <span class="text-gold">✓</span>
            Photos & travel time included
          </li>
        </ul>
      </CardContent>
    </Card>

    <!-- Monthly Plan -->
    <Card class="border-gold/30 bg-gold/10 relative overflow-hidden backdrop-blur-xl">
      <div
        class="bg-gold text-forest absolute top-0 right-0 rounded-bl-lg px-3 py-1 text-xs font-bold"
      >
        BEST VALUE
      </div>
      <CardContent class="p-6">
        <div class="mb-4 flex items-baseline justify-between">
          <h2 class="text-cream font-[Fraunces] text-2xl font-bold">Monthly</h2>
          <span class="text-gold text-xl font-semibold"
            >$1<span class="text-mist text-sm">/month</span></span
          >
        </div>
        <p class="text-mist mb-6 leading-relaxed">
          No limits, no stress. Every park unlocked, pick whenever you want. Less than a coffee.
        </p>
        <ul class="text-cream space-y-3 text-sm">
          <li class="flex items-center gap-2">
            <span class="text-gold">✓</span>
            All parks unlocked
          </li>
          <li class="flex items-center gap-2">
            <span class="text-gold">✓</span>
            Unlimited picks
          </li>
          <li class="flex items-center gap-2">
            <span class="text-gold">✓</span>
            Visit tracking
          </li>
          <li class="flex items-center gap-2">
            <span class="text-gold">✓</span>
            Cancel anytime
          </li>
        </ul>
      </CardContent>
    </Card>
  </div>

  <!-- Pricing Table from Clerk (for actual subscription management) -->
  <div class="pricing-table-wrapper">
    <PricingTable />
  </div>

  <!-- FAQ Section -->
  <Card class="border-white/15 bg-white/10 backdrop-blur-xl">
    <CardContent class="p-6">
      <h2 class="text-cream mb-4 font-[Fraunces] text-xl font-semibold">
        Frequently Asked Questions
      </h2>

      <div class="space-y-4">
        <details class="group" open>
          <summary
            class="text-cream hover:text-gold flex cursor-pointer list-none items-center justify-between font-semibold transition-colors"
          >
            What payment methods do you accept?
            <span class="text-mist transition-transform group-open:rotate-180">▼</span>
          </summary>
          <p class="text-mist mt-2 text-sm">
            We accept all major credit cards (Visa, Mastercard, American Express) through our secure
            payment processor, Stripe.
          </p>
        </details>

        <details class="group">
          <summary
            class="text-cream hover:text-gold flex cursor-pointer list-none items-center justify-between font-semibold transition-colors"
          >
            Can I change my plan later?
            <span class="text-mist transition-transform group-open:rotate-180">▼</span>
          </summary>
          <p class="text-mist mt-2 text-sm">
            Yes! You can upgrade or downgrade your plan at any time. Changes take effect at the
            start of your next billing period.
          </p>
        </details>

        <details class="group">
          <summary
            class="text-cream hover:text-gold flex cursor-pointer list-none items-center justify-between font-semibold transition-colors"
          >
            Is there a free trial?
            <span class="text-mist transition-transform group-open:rotate-180">▼</span>
          </summary>
          <p class="text-mist mt-2 text-sm">
            You can try {SITE_NAME} with a limited set of features before subscribing. Sign up to see
            what's available in the free tier.
          </p>
        </details>

        <details class="group">
          <summary
            class="text-cream hover:text-gold flex cursor-pointer list-none items-center justify-between font-semibold transition-colors"
          >
            How do I cancel my subscription?
            <span class="text-mist transition-transform group-open:rotate-180">▼</span>
          </summary>
          <p class="text-mist mt-2 text-sm">
            You can cancel anytime from your account settings. Click your profile icon and select
            "Manage Account" to access billing options. Your access continues until the end of your
            current billing period.
          </p>
        </details>

        <details class="group">
          <summary
            class="text-cream hover:text-gold flex cursor-pointer list-none items-center justify-between font-semibold transition-colors"
          >
            Do you offer refunds?
            <span class="text-mist transition-transform group-open:rotate-180">▼</span>
          </summary>
          <p class="text-mist mt-2 text-sm">
            We don't offer refunds for partial billing periods. However, if you're unsatisfied
            within the first 7 days, <a href="/help/contact" class="text-gold hover:underline"
              >contact us</a
            > and we'll work something out.
          </p>
        </details>
      </div>
    </CardContent>
  </Card>

  <footer slot="footer" class="mt-8 border-t border-white/10 pt-4">
    <nav class="text-mist flex justify-center gap-6 text-sm">
      <a href="/" class="hover:text-cream transition-colors">Home</a>
      <a href="/about" class="hover:text-cream transition-colors">About</a>
      <a href="/help" class="hover:text-cream transition-colors">Help</a>
      <a href="/legal/terms" class="hover:text-cream transition-colors">Terms</a>
      <a href="/legal/privacy" class="hover:text-cream transition-colors">Privacy</a>
    </nav>
  </footer>
</PageLayout>

<style>
  /* Style overrides for Clerk PricingTable to match app theme */
  .pricing-table-wrapper {
    --clerk-surface-background: rgba(255, 255, 255, 0.1);
    --clerk-elements-card-background: rgba(255, 255, 255, 0.05);
  }

  .pricing-table-wrapper :global(.cl-pricingTable-root) {
    background: transparent;
  }
</style>
